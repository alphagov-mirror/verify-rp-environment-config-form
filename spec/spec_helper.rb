require 'capybara/rspec'
require 'webmock/rspec'
require 'rack_session_access/capybara'

RSpec.configure do |config|
  config.expect_with :rspec do |expectations|
    expectations.include_chain_clauses_in_custom_matcher_descriptions = true
  end

  config.mock_with :rspec do |mocks|
    mocks.verify_partial_doubles = true
  end

  config.shared_context_metadata_behavior = :apply_to_host_groups

end

# issuer = IDAP Relying Party Test CA
GOOD_CERT_GOOD_ISSUER_INTEGRATION = <<~EOF
    -----BEGIN CERTIFICATE-----
    MIIESzCCAzOgAwIBAgIQWOgpeRnCWtyIxyygsV5AkTANBgkqhkiG9w0BAQsFADBZ
    MQswCQYDVQQGEwJHQjEXMBUGA1UEChMOQ2FiaW5ldCBPZmZpY2UxDDAKBgNVBAsT
    A0dEUzEjMCEGA1UEAxMaSURBUCBSZWx5aW5nIFBhcnR5IFRlc3QgQ0EwHhcNMTcw
    NTA4MDAwMDAwWhcNMTgwNTA4MjM1OTU5WjBoMQswCQYDVQQGEwJHQjEOMAwGA1UE
    CBMFV2FsZXMxEDAOBgNVBAcTB1N3YW5zZWExDTALBgNVBAoUBERWTEExDDAKBgNV
    BAsUA0lFUDEaMBgGA1UEAxMRRFZMQVZETFBQTVNBU2lnbjEwggEiMA0GCSqGSIb3
    DQEBAQUAA4IBDwAwggEKAoIBAQDErRn/E8TAFOab0IwfAELlc8UN9Lx9w1SXTkRy
    ahB9z+FrnhYkyOGiIrM2logqbi4gHOpwVX616X7qkaKms+mT/elIGHjPJ2dKvShU
    W91TrW2llAHRVrI4LYrMn8uan5Ci3gx7LSsCM+T6OZ6d5rQp2QMgzeg+lqTjEmi1
    5Jk3ySyDVHcBvCpz2lBL8k3wKbmdWH/hWZRq9zbAA/TA466ExGr6p0jUGQrKLwcL
    +647h0F2pX4OipajQSTOSAygXLt+unEETB8ThmWCgjLs5+kt8IavK7WDERBiqpoq
    +sFkLaycjFAQ64zD+wf2XQezVN3szjwXqWUvPlsVAfFlr/kHAgMBAAGjgf8wgfww
    DAYDVR0TAQH/BAIwADBhBgNVHR8EWjBYMFagVKBShlBodHRwOi8vb25zaXRlY3Js
    LnRydXN0d2lzZS5jb20vQ2FiaW5ldE9mZmljZUlEQVBSZWx5aW5nUGFydHlUZXN0
    Q0EvTGF0ZXN0Q1JMLmNybDAOBgNVHQ8BAf8EBAMCB4AwHQYDVR0OBBYEFIF2UsnT
    ht2BfyfyqRhhBVM72jYxMB8GA1UdIwQYMBaAFN3k9V0aCg860UgiHk7A+G429sUl
    MDkGCCsGAQUFBwEBBC0wKzApBggrBgEFBQcwAYYdaHR0cDovL3N0ZC1vY3NwLnRy
    dXN0d2lzZS5jb20wDQYJKoZIhvcNAQELBQADggEBAH5W61Tbre9WPUsK83hB27ZI
    9rUQA9aHcxYm+7Iz9jv+UPaVf6H5y5YA+BU1KFKGdKSIVuPXxyucgR69E6x5pSDl
    hg6WuhY1+1FGC6o1plts6CAaMN9XHxihr3RGPFyr3kLs/7dI66gnpGRhQKWHehbQ
    n7ZHpbP6YjUlgE8Esqms2FHhBmkraLhTvT6noaadBeUaJUi80CYXHtM/DPtS8dfp
    aOzuNpGoas5v4OVi9z/vodttvIGzhcvzdkprqGgPOYR7kipGxtDFxJHao/FJQN2e
    m1vRiVKN3gql7ai+FDlWDc+rT8/9ofwqFBqTEqIqh1Ypm5wALlAWBcRL/eRVHBM=
    -----END CERTIFICATE-----
EOF

GOOD_CERT_GOOD_ISSUER_INTEGRATION_FLAT = "MIIESzCCAzOgAwIBAgIQWOgpeRnCWtyIxyygsV5AkTANBgkqhkiG9w0BAQsFADBZMQswCQYDVQQGEwJHQjEXMBUGA1UEChMOQ2FiaW5ldCBPZmZpY2UxDDAKBgNVBAsTA0dEUzEjMCEGA1UEAxMaSURBUCBSZWx5aW5nIFBhcnR5IFRlc3QgQ0EwHhcNMTcwNTA4MDAwMDAwWhcNMTgwNTA4MjM1OTU5WjBoMQswCQYDVQQGEwJHQjEOMAwGA1UECBMFV2FsZXMxEDAOBgNVBAcTB1N3YW5zZWExDTALBgNVBAoUBERWTEExDDAKBgNVBAsUA0lFUDEaMBgGA1UEAxMRRFZMQVZETFBQTVNBU2lnbjEwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDErRn/E8TAFOab0IwfAELlc8UN9Lx9w1SXTkRyahB9z+FrnhYkyOGiIrM2logqbi4gHOpwVX616X7qkaKms+mT/elIGHjPJ2dKvShUW91TrW2llAHRVrI4LYrMn8uan5Ci3gx7LSsCM+T6OZ6d5rQp2QMgzeg+lqTjEmi15Jk3ySyDVHcBvCpz2lBL8k3wKbmdWH/hWZRq9zbAA/TA466ExGr6p0jUGQrKLwcL+647h0F2pX4OipajQSTOSAygXLt+unEETB8ThmWCgjLs5+kt8IavK7WDERBiqpoq+sFkLaycjFAQ64zD+wf2XQezVN3szjwXqWUvPlsVAfFlr/kHAgMBAAGjgf8wgfwwDAYDVR0TAQH/BAIwADBhBgNVHR8EWjBYMFagVKBShlBodHRwOi8vb25zaXRlY3JsLnRydXN0d2lzZS5jb20vQ2FiaW5ldE9mZmljZUlEQVBSZWx5aW5nUGFydHlUZXN0Q0EvTGF0ZXN0Q1JMLmNybDAOBgNVHQ8BAf8EBAMCB4AwHQYDVR0OBBYEFIF2UsnTht2BfyfyqRhhBVM72jYxMB8GA1UdIwQYMBaAFN3k9V0aCg860UgiHk7A+G429sUlMDkGCCsGAQUFBwEBBC0wKzApBggrBgEFBQcwAYYdaHR0cDovL3N0ZC1vY3NwLnRydXN0d2lzZS5jb20wDQYJKoZIhvcNAQELBQADggEBAH5W61Tbre9WPUsK83hB27ZI9rUQA9aHcxYm+7Iz9jv+UPaVf6H5y5YA+BU1KFKGdKSIVuPXxyucgR69E6x5pSDlhg6WuhY1+1FGC6o1plts6CAaMN9XHxihr3RGPFyr3kLs/7dI66gnpGRhQKWHehbQn7ZHpbP6YjUlgE8Esqms2FHhBmkraLhTvT6noaadBeUaJUi80CYXHtM/DPtS8dfpaOzuNpGoas5v4OVi9z/vodttvIGzhcvzdkprqGgPOYR7kipGxtDFxJHao/FJQN2em1vRiVKN3gql7ai+FDlWDc+rT8/9ofwqFBqTEqIqh1Ypm5wALlAWBcRL/eRVHBM="


# issuer = IDAP Relying Party CA G2
GOOD_CERT_GOOD_ISSUER_PRODUCTION = <<~EOF
    -----BEGIN CERTIFICATE-----
    MIIEMDCCAxigAwIBAgIQe4G9wv6mowO/ts2vnfiamDANBgkqhkiG9w0BAQsFADBX
    MQswCQYDVQQGEwJHQjEXMBUGA1UEChMOQ2FiaW5ldCBPZmZpY2UxDDAKBgNVBAsT
    A0dEUzEhMB8GA1UEAxMYSURBUCBSZWx5aW5nIFBhcnR5IENBIEcyMB4XDTE3MDUw
    NTAwMDAwMFoXDTE4MDEzMDIzNTk1OVowVDELMAkGA1UEBhMCR0IxDjAMBgNVBAgT
    BVdhbGVzMQ0wCwYDVQQKFAREVkxBMQwwCgYDVQQLFANJRVAxGDAWBgNVBAMTD0RW
    TEFWRExNU0FTaWduMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBANMM
    C3j1SvRLvhcnrAMp2s2cVSD0l/jjaf/xOmamJAAdMLU8D2JTL9QMkgLjH74aPMi8
    Ran24H2ltJ/2y3icJ4Gk208VNzGLNzY59qzX70xICisc8qJi1r9vidfHpESHzTe0
    voejuGz3ouLMlKs3rUrri3+my6MJmvMca0u+wGC0Irv0hmrII3qItlFhvmXOIZXK
    3RcIme4Pp/frfIHF0koZWAzronbjqIky7OUCIul8hAJAXcHzsrprenNi40tVNLIX
    Co0Lc6jYwln3AKvpafFS0tWiMxs8/iIyAN9QXfeycUs8WJzxtt19W/FzuPXm1n9P
    w0iTBuv4D+Wsul4SEPMCAwEAAaOB+jCB9zAJBgNVHRMEAjAAMF8GA1UdHwRYMFYw
    VKBSoFCGTmh0dHA6Ly9vbnNpdGVjcmwudHJ1c3R3aXNlLmNvbS9DYWJpbmV0T2Zm
    aWNlSURBUFJlbHlpbmdQYXJ0eUNBRzIvTGF0ZXN0Q1JMLmNybDAOBgNVHQ8BAf8E
    BAMCB4AwHQYDVR0OBBYEFCkJjSk/jiEF4lZw2wvs8xc9k/SNMB8GA1UdIwQYMBaA
    FPuMXnfGJsSVEjsMe83j5OmQyG+rMDkGCCsGAQUFBwEBBC0wKzApBggrBgEFBQcw
    AYYdaHR0cDovL3N0ZC1vY3NwLnRydXN0d2lzZS5jb20wDQYJKoZIhvcNAQELBQAD
    ggEBAEY+AAmXHWYJpAXIwZ/w15G/JumKJ+34Ckmxak+JhnkKQEmmQLntCFFBAfeS
    TQSukrM3IWQ8Bv39VSRsbxO0hK7widVZkLLj1b1QitNd6DTcshg1fpwVaxtggxpu
    phfSuALCsc8i3CIXq1VwXnvAfrYNK8oN7D05qZgBdJyzv7lCzbBMgDsnqDLT9uTB
    0oYlcuZ1zmHvUJ2RWPgqw6KAPA6bU/glkKm1WAxbo+aXlfT1MA2ACjbGzdo1sXdY
    R0NEh1Q2NwV8Wll+5HYi0W8/Xv7Lj6v58cOXdUZqDVyf+wCRNYRRJ+n9+pzbjZuV
    GOvNtR9QjAPo458og+cZeRlQYbE=
    -----END CERTIFICATE-----
EOF

GOOD_CERT_BAD_ISSUER = <<~EOF
    -----BEGIN CERTIFICATE-----
    MIICvDCCAaQCCQDiHF/Fhzl3BTANBgkqhkiG9w0BAQsFADAgMR4wHAYDVQQDFBV0
    ZXN0X21zYV9lbmNyeXB0aW9uXzEwHhcNMTcwMjAzMTcyOTUzWhcNMTcwMzA1MTcy
    OTUzWjAgMR4wHAYDVQQDFBV0ZXN0X21zYV9lbmNyeXB0aW9uXzEwggEiMA0GCSqG
    SIb3DQEBAQUAA4IBDwAwggEKAoIBAQCm9pfAowd8lzAvDzzeS2Y7XPtE8ofjbxB8
    /c9Dnpg3mVPaL/ZiOVaSSGZnGHIZdSIyikICdD+52pZ4WYLVwldSKHzLfdEOgZWE
    1FRd84SEDGWVCgTpeBCW7Gdo84Gf449zr/by9bzuFxBY8F6eC7qJQZq8q2Yf/gKi
    JbbDsqpBpdloLnkS/HEyYHgI4auJEEGQxdhPXJ5FQdipvgP/MbS0me9k+bfYBFvV
    IgxRb4Tkgskq+A/RUZXVkWfrH93LX+KbcRtudtjWrTM7bb1xR4jo5wbT5UTXDF/P
    8P844aERSyiLQWDkq8XT4TJCxq3C8uSixnkTkTXd7zWcIWvkDmoZAgMBAAEwDQYJ
    KoZIhvcNAQELBQADggEBAF64j02nUVj8sVz4zQSg6fQR3ySWF5RJvaecukm79LXr
    9yhILXqo0Q87nPC9QNQTmLDUxPD3qV2sHIifcBm3FG//Dv+dJPsgvrgEqwKRmIMe
    wk92W9J7G4MeeOzHkU4DUT8l5vm/rbt60sVKp1J8K+W20X5qURqdDTHzzbAJt1Ce
    syQS3DuN/JxhTp3g3xPNe//XmQ7hbzrL1UBX1b/z7Oqilhvx3ZRp6hRuY/QKdn9I
    8LgfN/rnWkfhOxkIjcqL3/fwdJGgHMcSpweWLsjabjstmZ0ZpxAHYM8kVuZY6aHG
    WAgWh/LCQgDC+3z6SMSyiip7qi1qWWmx7C1NScqLvPQ=
    -----END CERTIFICATE-----
EOF
